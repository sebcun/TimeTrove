<h1
  class="text-4xl md:text-6xl font-extrabold mb-1 text-center text-[#ffd036] dark:text-[#ffd036]"
>
  {{ CAPSULENAME }}
</h1>
<h6
  class="text-lg md:text-lg font-medium mb-1 text-center text-[#000000] dark:text-gray-300"
>
  This capsule was sealed on the
  <span
    class="font-extrabold"
    id="sealedAt"
    data-createdat="{{ CREATEDAT }}"
  ></span>
  and opened on the
  <span
    class="font-extrabold"
    id="openedAt"
    data-readyat="{{ READYAT }}"
  ></span>
</h6>
<h1
  class="text-l md:text-l font-medium mb-3 text-center text-[#000000] dark:text-gray-300 mx-14"
>
  {{ CAPSULEDESCRIPTION }}
</h1>

<h1
  class="text-2xl md:text-2xl font-bold mb-3 text-center text-[#000000] dark:text-gray-300 mx-14"
>
  TIME CAPSULE CONTENTS
</h1>

{% for item in CAPSULECONTENTS %} {% if item.type == 'text' %}
<div class="mb-4">
  <div class="w-full">
    <div
      class="text-center block w-full rounded-md bg-white dark:bg-[#232323] border border-gray-300 dark:border-gray-700 px-3 py-1.5 pr-14 text-base text-[#000000] dark:text-gray-200 outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-500 sm:text-sm/6 transition"
    >
      {{item.value}}
    </div>
  </div>
</div>
{% elif item.type == 'link' %}
<div class="mb-4">
  <div class="w-full">
    <a
      href="{{item.value}}"
      target="_blank"
      class="text-center block w-full rounded-md bg-white dark:bg-[#232323] border border-gray-300 dark:border-gray-700 px-3 py-1.5 pr-14 text-base text-[#000000] dark:text-gray-200 outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-500 sm:text-sm/6 transition"
      ><i class="bi bi-link-45deg text-[#000000] dark:text-gray-200"></i>
      {{item.value}}
    </a>
  </div>
</div>
{% elif item.type == 'file' and item.value.lower().endswith('.mp4') %}
<div class="mb-4">
  <div class="w-full text-center">
    <video
      width="810"
      height="400"
      controls
      class="inline-block rounded-md border border-gray-300 dark:border-gray-700 max-w-full h-auto"
    >
      <source
        src="/download/{{CAPSULEID}}/{{item.serverPath}}"
        type="video/mp4"
      />
      Your browser does not support the video tag.
    </video>
    <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">
      <a href="/download/{{CAPSULEID}}/{{item.serverPath}}" target="_blank">
        {{item.value}}
      </a>
    </div>
  </div>
</div>
{% elif item.type == 'file' %}
<div class="mb-4">
  <div class="w-full">
    <a
      href="/download/{{CAPSULEID}}/{{item.serverPath}}"
      target="_blank"
      class="text-center block w-full rounded-md bg-white dark:bg-[#232323] border border-gray-300 dark:border-gray-700 px-3 py-1.5 pr-14 text-base text-[#000000] dark:text-gray-200 outline-1 -outline-offset-1 outline-white/10 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-500 sm:text-sm/6 transition"
      ><i class="bi bi-file-earmark text-[#000000] dark:text-gray-200"></i>
      {{item.value}}
    </a>
  </div>
</div>
{% elif item.type == 'image' %}
<div class="mb-4">
  <div class="w-full text-center">
    <img
      src="/download/{{CAPSULEID}}/{{item.serverPath}}"
      alt="{{item.value}}"
      class="inline-block rounded-md border border-gray-300 dark:border-gray-700 max-w-full h-auto"
      style="max-height: 400px"
    />
    <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">
      <a href="/download/{{CAPSULEID}}/{{item.serverPath}}" target="_blank">
        {{item.value}}
      </a>
    </div>
  </div>
</div>
{% endif %} {% endfor %}

<script>
  function formatUnixTimestamp(ts) {
    const dt = new Date(ts * 1000);

    const day = dt.getDate();
    const suffix =
      day >= 11 && day <= 13
        ? "th"
        : day % 10 === 1
        ? "st"
        : day % 10 === 2
        ? "nd"
        : day % 10 === 3
        ? "rd"
        : "th";

    const month = dt.toLocaleString("en-US", { month: "long" });
    const year = dt.getFullYear();

    let hours = dt.getHours();
    const minutes = dt.getMinutes().toString().padStart(2, "0");
    const ampm = hours >= 12 ? "PM" : "AM";
    hours = hours % 12 || 12;

    return `${day}${suffix} ${month} ${year} at ${hours}:${minutes}${ampm}`;
  }

  function loadDates() {
    const sealedAtElem = document.getElementById("sealedAt");
    const openedAtElem = document.getElementById("openedAt");

    const sealedAt = parseInt(sealedAtElem.dataset.createdat);
    const openedAt = parseInt(openedAtElem.dataset.readyat);

    sealedAtElem.textContent = formatUnixTimestamp(sealedAt);
    openedAtElem.textContent = formatUnixTimestamp(openedAt);
  }

  document.addEventListener("DOMContentLoaded", loadDates);
</script>
